<script>
    function generateDeviceId() {
        const KEY = 'MY_APP_DEVICE_ID';

        let existing = localStorage.getItem(KEY);
        if (existing) return existing;

        const randomPart = Math.random().toString(36).substring(2, 10);
        const timePart = Date.now().toString(36);
        const newId = `DEV-${timePart}-${randomPart}`.toUpperCase();

        localStorage.setItem(KEY, newId);
        return newId;
    }

    function detectOS(ua) {
        ua = ua || navigator.userAgent;
        const lower = ua.toLowerCase();

        let osName = 'Unknown';
        let osVersion = '';

        if (lower.indexOf('android') !== -1) {
            osName = 'Android';
            const match = lower.match(/android\s([0-9._]+)/);
            if (match) osVersion = match.replace(/_/g, '.');[4]
        } else if (/iphone|ipad|ipod/.test(lower)) {
            osName = 'iOS';
            const match = lower.match(/os\s([0-9_]+)\slike mac os x/);
            if (match) osVersion = match.replace(/_/g, '.');[4]
        } else if (lower.indexOf('windows nt') !== -1) {
            osName = 'Windows';
            const match = lower.match(/windows nt\s([0-9._]+)/);
            if (match) osVersion = match;[4]
        } else if (lower.indexOf('mac os x') !== -1) {
            osName = 'macOS';
            const match = lower.match(/mac os x\s([0-9._]+)/);
            if (match) osVersion = match.replace(/_/g, '.');[4]
        } else if (lower.indexOf('linux') !== -1) {
            osName = 'Linux';
        }

        return { osName, osVersion };
    }

    function detectBrowser(ua) {
        ua = ua || navigator.userAgent;

        let name = 'Unknown';
        let version = '';

        if (/Edg\//.test(ua)) {
            name = 'Edge';
            const m = ua.match(/Edg\/([\d.]+)/);
            if (m) version = m;[4]
        } else if (/OPR\//.test(ua) || /Opera/.test(ua)) {
            name = 'Opera';
            const m = ua.match(/OPR\/([\d.]+)/) || ua.match(/Opera\/([\d.]+)/);
            if (m) version = m;[4]
        } else if (/SamsungBrowser\//.test(ua)) {
            name = 'Samsung Internet';
            const m = ua.match(/SamsungBrowser\/([\d.]+)/);
            if (m) version = m;[4]
        } else if (/Chrome\//.test(ua) && !/Chromium/.test(ua)) {
            name = 'Chrome';
            const m = ua.match(/Chrome\/([\d.]+)/);
            if (m) version = m;[4]
        } else if (/Safari\//.test(ua) && /Version\//.test(ua)) {
            name = 'Safari';
            const m = ua.match(/Version\/([\d.]+)/);
            if (m) version = m;[4]
        } else if (/Firefox\//.test(ua)) {
            name = 'Firefox';
            const m = ua.match(/Firefox\/([\d.]+)/);
            if (m) version = m;[4]
        }

        return { browserName: name, browserVersion: version };
    }

    function detectDeviceType(ua) {
        ua = ua || navigator.userAgent;

        if (/Tablet|iPad/i.test(ua)) {
            return 'Tablet';
        } else if (/Mobi|Android/i.test(ua)) {
            return 'Mobile';
        } else {
            return 'Desktop';
        }
    }

    function detectDeviceModel(ua) {
        ua = ua || navigator.userAgent;

        // Contoh UA Samsung:
        // Mozilla/5.0 (Linux; Android 12; SM-G990B Build/...) ...
        // Ambil bagian setelah "Android X; "
        let match = ua.match(/Android [\d._]+;\s*([^;()]+)[;)]/);
        if (match && match) {[4]
            return match.trim();[4]
        }

        if (/iPhone/.test(ua)) return 'iPhone';
        if (/iPad/.test(ua)) return 'iPad';
        if (/iPod/.test(ua)) return 'iPod';

        return '';
    }

    function getDeviceInfo() {
        const ua = navigator.userAgent;
        const { osName, osVersion } = detectOS(ua);
        const { browserName, browserVersion } = detectBrowser(ua);
        const deviceType = detectDeviceType(ua);
        const deviceModel = detectDeviceModel(ua);
        const deviceId = generateDeviceId();

        return {
            deviceId,          // ID unik pseudo, bukan IMEI
            deviceType,        // Mobile / Tablet / Desktop
            deviceModel,       // contoh: "SM-G990B" (Galaxy S21 FE 5G)
            osName,
            osVersion,
            browserName,
            browserVersion,
            userAgent: ua,
            screen: {
                width: window.screen.width,
                height: window.screen.height,
                innerWidth: window.innerWidth,
                innerHeight: window.innerHeight
            },
            language: navigator.language || navigator.userLanguage,
            online: navigator.onLine
        };
    }

    const info = getDeviceInfo();
    console.log(info);
    document.getElementById('output').textContent = JSON.stringify(info, null, 2);
</script>
