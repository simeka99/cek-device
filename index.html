<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <title>Deteksi Device</title>
</head>
<body>
  <h1>Deteksi Device</h1>
  <pre id="output"></pre>

  <script>
    // ====== 1. Mapping kode â†’ nama HP ======
    const SAMSUNG_MODEL_MAP = {
      // Galaxy S21 FE 5G varian umum
      'SM-G990B': 'Samsung Galaxy S21 FE 5G',
      'SM-G990E': 'Samsung Galaxy S21 FE 5G',
      'SM-G990U': 'Samsung Galaxy S21 FE 5G',
      'SM-G990W': 'Samsung Galaxy S21 FE 5G',
      // Tambah sendiri:
      // 'SM-S911B': 'Samsung Galaxy S23',
      // 'SM-A146P': 'Samsung Galaxy A14 5G',
    };

    // ====== 2. Generate deviceId buatan (ganti IMEI) ======
    function generateDeviceId() {
      const KEY = 'MY_APP_DEVICE_ID';
      let existing = localStorage.getItem(KEY);
      if (existing) return existing;

      const rnd = Math.random().toString(36).substring(2, 10);
      const time = Date.now().toString(36);
      const newId = `DEV-${time}-${rnd}`.toUpperCase();
      localStorage.setItem(KEY, newId);
      return newId;
    }

    // ====== 3. Deteksi OS dari userAgent ======
    function detectOS(ua) {
      ua = ua.toLowerCase();
      let osName = 'Unknown';
      let osVersion = '';

      if (ua.includes('android')) {
        osName = 'Android';
        const m = ua.match(/android\s([0-9._]+)/);
        if (m) osVersion = m[1].replace(/_/g, '.');
      } else if (/iphone|ipad|ipod/.test(ua)) {
        osName = 'iOS';
        const m = ua.match(/os\s([0-9_]+)\slike mac os x/);
        if (m) osVersion = m[1].replace(/_/g, '.');
      } else if (ua.includes('windows nt')) {
        osName = 'Windows';
        const m = ua.match(/windows nt\s([0-9._]+)/);
        if (m) osVersion = m[1];
      } else if (ua.includes('mac os x')) {
        osName = 'macOS';
        const m = ua.match(/mac os x\s([0-9._]+)/);
        if (m) osVersion = m[1].replace(/_/g, '.');
      } else if (ua.includes('linux')) {
        osName = 'Linux';
      }

      return { osName, osVersion };
    }

    // ====== 4. Deteksi browser ======
    function detectBrowser(ua) {
      let name = 'Unknown';
      let version = '';

      if (/Edg\//.test(ua)) {
        name = 'Edge';
        const m = ua.match(/Edg\/([\d.]+)/);
        if (m) version = m[1];
      } else if (/OPR\//.test(ua) || /Opera/.test(ua)) {
        name = 'Opera';
        const m = ua.match(/OPR\/([\d.]+)/) || ua.match(/Opera\/([\d.]+)/);
        if (m) version = m[1];
      } else if (/SamsungBrowser\//.test(ua)) {
        name = 'Samsung Internet';
        const m = ua.match(/SamsungBrowser\/([\d.]+)/);
        if (m) version = m[1];
      } else if (/Chrome\//.test(ua) && !/Chromium/.test(ua)) {
        name = 'Chrome';
        const m = ua.match(/Chrome\/([\d.]+)/);
        if (m) version = m[1];
      } else if (/Safari\//.test(ua) && /Version\//.test(ua)) {
        name = 'Safari';
        const m = ua.match(/Version\/([\d.]+)/);
        if (m) version = m[1];
      } else if (/Firefox\//.test(ua)) {
        name = 'Firefox';
        const m = ua.match(/Firefox\/([\d.]+)/);
        if (m) version = m[1];
      }

      return { browserName: name, browserVersion: version };
    }

    // ====== 5. Ambil kode model Samsung dari userAgent ======
    function detectSamsungModelCode(ua) {
      // pola umum: SM-G990E, SM-S918B, SM-A146P, dsb
      const match = ua.match(/SM-[A-Z0-9]+/);
      return match ? match[0] : '';
    }

    // ====== 6. Device type ======
    function detectDeviceType(ua) {
      if (/Tablet|iPad/i.test(ua)) return 'Tablet';
      if (/Mobi|Android/i.test(ua)) return 'Mobile';
      return 'Desktop';
    }

    // ====== 7. Fungsi utama: getDeviceInfo ======
    function getDeviceInfo() {
      const ua = navigator.userAgent;
      const { osName, osVersion } = detectOS(ua);
      const { browserName, browserVersion } = detectBrowser(ua);
      const deviceType = detectDeviceType(ua);

      // ambil kode model samsung, kalau ada
      const samsungModelCode = detectSamsungModelCode(ua);
      const samsungModelName = samsungModelCode
        ? (SAMSUNG_MODEL_MAP[samsungModelCode] || 'Samsung ' + samsungModelCode)
        : '';

      return {
        // 1. Nama Model
        modelName: samsungModelName || 'TIDAK DIKETAHUI DARI BROWSER',

        // tambahan: kode model mentah
        modelCode: samsungModelCode || '',

        // 2. No Serial (tidak bisa diambil di browser)
        serialNumber: 'TIDAK_BISA_DIAMBIL_DI_BROWSER',

        // 3. IMEI (tidak bisa diambil di browser)
        imei: 'TIDAK_BISA_DIAMBIL_DI_BROWSER',

        // Device ID buatan (ganti IMEI untuk identifikasi)
        deviceId: generateDeviceId(),

        deviceType,
        osName,
        osVersion,
        browserName,
        browserVersion,
        userAgent: ua,
        screen: {
          width: window.screen.width,
          height: window.screen.height,
          innerWidth: window.innerWidth,
          innerHeight: window.innerHeight
        },
        language: navigator.language || navigator.userLanguage,
        online: navigator.onLine
      };
    }

    // ====== 8. Contoh pakai ======
    const info = getDeviceInfo();
    console.log(info);
    document.getElementById('output').textContent = JSON.stringify(info, null, 2);
  </script>
</body>
</html>
