<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <title>Super Device Fingerprint</title>
</head>
<body>
    <h2>SUPER DEVICE FINGERPRINT</h2>
    <pre id="output"></pre>

<script>

// ======================================================
// 1. HASH HELPER (SHA-256)
// ======================================================
async function sha256(text) {
    const encoder = new TextEncoder();
    const data = encoder.encode(text);
    const hashBuffer = await crypto.subtle.digest("SHA-256", data);
    return Array.from(new Uint8Array(hashBuffer))
        .map(b => b.toString(16).padStart(2, "0"))
        .join("");
}

// ======================================================
// 2. WebGL Fingerprint
// ======================================================
function getWebGLInfo() {
    try {
        const canvas = document.createElement("canvas");
        const gl = canvas.getContext("webgl") || canvas.getContext("experimental-webgl");
        if (!gl) return { vendor: "none", renderer: "none" };

        const debugInfo = gl.getExtension("WEBGL_debug_renderer_info");

        return {
            vendor: gl.getParameter(debugInfo.UNMASKED_VENDOR_WEBGL),
            renderer: gl.getParameter(debugInfo.UNMASKED_RENDERER_WEBGL)
        };
    } catch (e) {
        return { vendor: "none", renderer: "none" };
    }
}

// ======================================================
// 3. Canvas Fingerprint
// ======================================================
function getCanvasFingerprint() {
    const canvas = document.createElement("canvas");
    const ctx = canvas.getContext("2d");

    ctx.textBaseline = "top";
    ctx.font = "16px Arial";
    ctx.fillStyle = "#09f";
    ctx.fillRect(30, 10, 200, 80);
    ctx.fillStyle = "#000";
    ctx.fillText("GYA TECH INDONESIA", 50, 30);

    return canvas.toDataURL();
}

// ======================================================
// 4. Audio Fingerprint
// ======================================================
function getAudioFingerprint() {
    try {
        const audioCtx = new (window.AudioContext || window.webkitAudioContext)();
        return audioCtx.sampleRate || "none";
    } catch (e) {
        return "none";
    }
}

// ======================================================
// 5. Device Model Detection (Samsung, Android, iPhone)
// ======================================================
function detectModelFromUA(ua) {
    // Samsung SM-xxxx
    const matchSamsung = ua.match(/SM-[A-Z0-9]+/);
    if (matchSamsung) return matchSamsung[0];

    // iPhone types
    if (/iPhone/.test(ua)) return "iPhone";
    if (/iPad/.test(ua)) return "iPad";

    return "";
}

// ======================================================
// 6. OS Detection
// ======================================================
function detectOS(ua) {
    ua = ua.toLowerCase();

    if (ua.includes("android")) {
        const v = ua.match(/android\s([0-9._]+)/);
        return { os: "Android", version: v ? v[1].replace(/_/g, ".") : "" };
    }

    if (/iphone|ipad|ipod/.test(ua)) {
        const v = ua.match(/os\s([0-9_]+)\slike/);
        return { os: "iOS", version: v ? v[1].replace(/_/g, ".") : "" };
    }

    if (ua.includes("windows nt")) {
        const v = ua.match(/windows nt\s([0-9._]+)/);
        return { os: "Windows", version: v ? v[1] : "" };
    }

    if (ua.includes("mac os x")) {
        const v = ua.match(/mac os x\s([0-9._]+)/);
        return { os: "macOS", version: v ? v[1].replace(/_/g, ".") : "" };
    }

    return { os: "Unknown", version: "" };
}

// ======================================================
// 7. Browser Detection
// ======================================================
function detectBrowser(ua) {
    let name = "Unknown";
    let ver = "";

    if (/Chrome\//.test(ua) && !/Edge\//.test(ua) && !/OPR\//.test(ua)) {
        name = "Chrome"; ver = ua.match(/Chrome\/([\d.]+)/)[1];
    } else if (/Edg\//.test(ua)) {
        name = "Edge"; ver = ua.match(/Edg\/([\d.]+)/)[1];
    } else if (/Firefox\//.test(ua)) {
        name = "Firefox"; ver = ua.match(/Firefox\/([\d.]+)/)[1];
    } else if (/Safari\//.test(ua) && /Version\//.test(ua)) {
        name = "Safari"; ver = ua.match(/Version\/([\d.]+)/)[1];
    }

    return { browser: name, version: ver };
}

// ======================================================
// 8. MAIN: GENERATE SUPER DEVICE ID
// ======================================================
async function generateSuperDeviceID() {

    const ua = navigator.userAgent;

    const os = detectOS(ua);
    const browser = detectBrowser(ua);
    const modelCode = detectModelFromUA(ua);

    const webgl = getWebGLInfo();
    const canvasFP = getCanvasFingerprint();
    const audioFP = getAudioFingerprint();

    const rawFingerprint = [
        ua,
        navigator.language,
        Intl.DateTimeFormat().resolvedOptions().timeZone,
        screen.width,
        screen.height,
        screen.colorDepth,
        window.devicePixelRatio,
        navigator.hardwareConcurrency,
        navigator.deviceMemory,
        navigator.platform,
        webgl.vendor,
        webgl.renderer,
        canvasFP,
        audioFP
    ].join("###");

    const hash = await sha256(rawFingerprint);

    const finalID = `DEVID-${hash.substring(0, 8)}-${hash.substring(8, 16)}-${hash.substring(16, 24)}`;

    return {
        deviceID: finalID,
        modelCode: modelCode,
        os: os.os,
        osVersion: os.version,
        browser: browser.browser,
        browserVersion: browser.version,
        gpuVendor: webgl.vendor,
        gpuRenderer: webgl.renderer,
        cpuCores: navigator.hardwareConcurrency || "unknown",
        memoryGB: navigator.deviceMemory || "unknown",
        audioFingerprint: audioFP,
        canvasFingerprint: canvasFP.substring(0, 30) + "...",
        userAgent: ua,
        screen: {
            width: screen.width,
            height: screen.height,
            colorDepth: screen.colorDepth,
            pixelRatio: window.devicePixelRatio
        },
        language: navigator.language,
        timezone: Intl.DateTimeFormat().resolvedOptions().timeZone
    };
}

// ======================================================
// 9. RUN & DISPLAY
// ======================================================
generateSuperDeviceID().then(info => {
    document.getElementById("output").textContent = JSON.stringify(info, null, 2);
    console.log(info);
});

</script>
</body>
</html>
